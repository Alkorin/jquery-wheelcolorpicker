/**
 * jQuery Wheel Color Picker
 * 
 * http://www.jar2.net/projects/jquery-wheelcolorpicker
 * 
 * Author : Fajar Chandra
 * Date   : 2016.01.02
 * 
 * Copyright Â© 2011-2016 Fajar Chandra. All rights reserved.
 * Released under MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(e){e.fn.wheelColorPicker=function(){var r=this;if(arguments.length>0)var i=[].shift,s=i.apply(arguments),o="string"==typeof s?s.charAt(0).toUpperCase()+s.slice(1):s;else var s=void 0,o=void 0;var a=arguments;return this.each(function(){var i=e(this).data("jQWCP.instance");if(void 0==i||null==i){var n={};"object"==typeof s&&(n=s),i=new t.ColorPicker(this,n),e(this).data("jQWCP.instance",i)}if(void 0===s||"object"==typeof s);else if("function"==typeof i[s]){var l=i[s].apply(i,a);if(l!==i)return r=l,!1}else if("function"==typeof i["set"+o]&&a.length>0){var l=i["set"+o].apply(i,a);if(l!==i)return r=l,!1}else if("function"==typeof i["get"+o]){var l=i["get"+o].apply(i,a);if(l!==i)return r=l,!1}else if(void 0!==i.options[s]&&a.length>0)i.options[s]=a[0];else{if(void 0!==i.options[s])return r=i.options[s],!1;e.error("Method/option named "+s+" does not exist on jQuery.wheelColorPicker")}}),r};var t=e.fn.wheelColorPicker;t.defaults={format:"hex",preview:!1,live:!0,userinput:!0,validate:!1,autoConvert:!0,preserveWheel:null,cssClass:"",layout:"popup",animDuration:200,quality:1,sliders:null,sliderLabel:!0,sliderValue:!1,rounding:2,mobile:!0,hideKeyboard:!1,htmlOptions:!0,snap:!1,snapTolerance:.05},t.BUG_RELATIVE_PAGE_ORIGIN=!1,t.ORIGIN={left:0,top:0},t.colorToStr=function(e,t){var r="";switch(t){case"css":r="#";case"hex":var i=Math.round(255*e.r).toString(16);1==i.length&&(i="0"+i);var s=Math.round(255*e.g).toString(16);1==s.length&&(s="0"+s);var o=Math.round(255*e.b).toString(16);1==o.length&&(o="0"+o),r+=i+s+o;break;case"rgb":r="rgb("+Math.round(255*e.r)+","+Math.round(255*e.g)+","+Math.round(255*e.b)+")";break;case"rgb%":r="rgb("+100*e.r+"%,"+100*e.g+"%,"+100*e.b+"%)";break;case"rgba":r="rgba("+Math.round(255*e.r)+","+Math.round(255*e.g)+","+Math.round(255*e.b)+","+e.a+")";break;case"rgba%":r="rgba("+100*e.r+"%,"+100*e.g+"%,"+100*e.b+"%,"+100*e.a+"%)";break;case"hsv":r="hsv("+360*e.h+","+e.s+","+e.v+")";break;case"hsv%":r="hsv("+100*e.h+"%,"+100*e.s+"%,"+100*e.v+"%)";break;case"hsva":r="hsva("+360*e.h+","+e.s+","+e.v+","+e.a+")";break;case"hsva%":r="hsva("+100*e.h+"%,"+100*e.s+"%,"+100*e.v+"%,"+100*e.a+"%)";break;case"hsb":r="hsb("+e.h+","+e.s+","+e.v+")";break;case"hsb%":r="hsb("+100*e.h+"%,"+100*e.s+"%,"+100*e.v+"%)";break;case"hsba":r="hsba("+e.h+","+e.s+","+e.v+","+e.a+")";break;case"hsba%":r="hsba("+100*e.h+"%,"+100*e.s+"%,"+100*e.v+"%,"+100*e.a+"%)"}return r},t.strToColor=function(e){var t,r,i={a:1};if(null!=e.match(/^#[0-9a-f]{6}$/i)){if(isNaN(i.r=parseInt(e.substr(1,2),16)/255))return!1;if(isNaN(i.g=parseInt(e.substr(3,2),16)/255))return!1;if(isNaN(i.b=parseInt(e.substr(5,2),16)/255))return!1}else if(null!=e.match(/^[0-9a-f]{6}$/i)){if(isNaN(i.r=parseInt(e.substr(0,2),16)/255))return!1;if(isNaN(i.g=parseInt(e.substr(2,2),16)/255))return!1;if(isNaN(i.b=parseInt(e.substr(4,2),16)/255))return!1}else if(null!=e.match(/^rgba\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i)||null!=e.match(/^rgb\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i)){if(r=null!=e.match(/a/i)?!0:!1,t=e.substring(e.indexOf("(")+1,e.indexOf(",")),"%"==t.charAt(t.length-1)){if(isNaN(i.r=parseFloat(t)/100))return!1}else if(isNaN(i.r=parseInt(t)/255))return!1;if(t=e.substring(e.indexOf(",")+1,e.indexOf(",",e.indexOf(",")+1)),"%"==t.charAt(t.length-1)){if(isNaN(i.g=parseFloat(t)/100))return!1}else if(isNaN(i.g=parseInt(t)/255))return!1;if(t=r?e.substring(e.indexOf(",",e.indexOf(",")+1)+1,e.lastIndexOf(",")):e.substring(e.lastIndexOf(",")+1,e.lastIndexOf(")")),"%"==t.charAt(t.length-1)){if(isNaN(i.b=parseFloat(t)/100))return!1}else if(isNaN(i.b=parseInt(t)/255))return!1;if(r)if(t=e.substring(e.lastIndexOf(",")+1,e.lastIndexOf(")")),"%"==t.charAt(t.length-1)){if(isNaN(i.a=parseFloat(t)/100))return!1}else if(isNaN(i.a=parseFloat(t)))return!1}else{if(null==e.match(/^hsva\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i)&&null==e.match(/^hsv\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i)&&null==e.match(/^hsba\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i)&&null==e.match(/^hsb\s*\(\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*,\s*([0-9\.]+%|[01]?\.?[0-9]*)\s*\)$/i))return!1;if(r=null!=e.match(/a/i)?!0:!1,t=e.substring(e.indexOf("(")+1,e.indexOf(",")),"%"==t.charAt(t.length-1)){if(isNaN(i.h=parseFloat(t)/100))return!1}else if(isNaN(i.h=parseFloat(t)/360))return!1;if(t=e.substring(e.indexOf(",")+1,e.indexOf(",",e.indexOf(",")+1)),"%"==t.charAt(t.length-1)){if(isNaN(i.s=parseFloat(t)/100))return!1}else if(isNaN(i.s=parseFloat(t)))return!1;if(t=r?e.substring(e.indexOf(",",e.indexOf(",")+1)+1,e.lastIndexOf(",")):e.substring(e.lastIndexOf(",")+1,e.lastIndexOf(")")),"%"==t.charAt(t.length-1)){if(isNaN(i.v=parseFloat(t)/100))return!1}else if(isNaN(i.v=parseFloat(t)))return!1;if(r)if(t=e.substring(e.lastIndexOf(",")+1,e.lastIndexOf(")")),"%"==t.charAt(t.length-1)){if(isNaN(i.a=parseFloat(t)/100))return!1}else if(isNaN(i.a=parseFloat(t)))return!1}return i},t.hsvToRgb=function(e,t,r){var i=1/6>=e||e>=5/6?1:1/3>e?1-6*(e-1/6):e>4/6?6*(e-4/6):0,s=e>=1/6&&.5>=e?1:1/6>e?6*e:4/6>e?1-6*(e-.5):0,o=e>=.5&&5/6>=e?1:e>2/6&&.5>e?6*(e-2/6):e>5/6?1-6*(e-5/6):0,a=(i+(1-i)*(1-t))*r,n=(s+(1-s)*(1-t))*r,l=(o+(1-o)*(1-t))*r;return{r:a,g:n,b:l}},t.rgbToHsv=function(e,t,r){var i,s,o,a=Math.max(e,t,r),n=Math.min(e,t,r),l=a-n;return s=0!=a?l/a:0,i=0==l?0:e==a?(6+(t-r)/l)%6:t==a?2+(r-e)/l:r==a?4+(e-t)/l:0,i/=6,o=a,{h:i,s:s,v:o}},t.ColorPicker=function(r,i){this.input=r,this.color={h:0,s:0,v:1,r:1,g:1,b:1,a:1},this.setValue(this.input.value),this.options=e.extend(!0,{},t.defaults),this.setOptions(i),null==this.options.sliders&&(this.options.sliders="wvp"+(this.options.format.indexOf("a")>=0?"a":"")),this.init()},t.ColorPicker.widget=null,t.ColorPicker.overlay=null,t.ColorPicker.init=function(){if(1!=t.ColorPicker.init.hasInit){t.ColorPicker.init.hasInit=!0;var r=e('<div class="jQWCP-overlay" style="display: none;"></div>');r.on("click",t.Handler.overlay_click),t.ColorPicker.overlay=r.get(0),e("body").append(r),e("html").on("mouseup.wheelColorPicker",t.Handler.html_mouseup),e("html").on("touchend.wheelColorPicker",t.Handler.html_mouseup),e("html").on("mousemove.wheelColorPicker",t.Handler.html_mousemove),e("html").on("touchmove.wheelColorPicker",t.Handler.html_mousemove)}},t.ColorPicker.createWidget=function(){var r=e("<div class='jQWCP-wWidget'><div class='jQWCP-wWheel'><div class='jQWCP-wWheelOverlay'></div><span class='jQWCP-wWheelCursor'></span></div><div class='jQWCP-wHue jQWCP-slider-wrapper'><canvas class='jQWCP-wHueSlider jQWCP-slider' width='1' height='50' title='Hue'></canvas><span class='jQWCP-wHueCursor jQWCP-scursor'></span></div><div class='jQWCP-wSat jQWCP-slider-wrapper'><canvas class='jQWCP-wSatSlider jQWCP-slider' width='1' height='50' title='Saturation'></canvas><span class='jQWCP-wSatCursor jQWCP-scursor'></span></div><div class='jQWCP-wVal jQWCP-slider-wrapper'><canvas class='jQWCP-wValSlider jQWCP-slider' width='1' height='50' title='Value'></canvas><span class='jQWCP-wValCursor jQWCP-scursor'></span></div><div class='jQWCP-wRed jQWCP-slider-wrapper'><canvas class='jQWCP-wRedSlider jQWCP-slider' width='1' height='50' title='Red'></canvas><span class='jQWCP-wRedCursor jQWCP-scursor'></span></div><div class='jQWCP-wGreen jQWCP-slider-wrapper'><canvas class='jQWCP-wGreenSlider jQWCP-slider' width='1' height='50' title='Green'></canvas><span class='jQWCP-wGreenCursor jQWCP-scursor'></span></div><div class='jQWCP-wBlue jQWCP-slider-wrapper'><canvas class='jQWCP-wBlueSlider jQWCP-slider' width='1' height='50' title='Blue'></canvas><span class='jQWCP-wBlueCursor jQWCP-scursor'></span></div><div class='jQWCP-wAlpha jQWCP-slider-wrapper'><canvas class='jQWCP-wAlphaSlider jQWCP-slider' width='1' height='50' title='Alpha'></canvas><span class='jQWCP-wAlphaCursor jQWCP-scursor'></span></div><div class='jQWCP-wPreview'><canvas class='jQWCP-wPreviewBox' width='1' height='1' title='Selected Color'></canvas></div></div>");return r.find(".jQWCP-wWheel, .jQWCP-slider-wrapper, .jQWCP-scursor, .jQWCP-slider").attr("unselectable","on").css("-moz-user-select","none").css("-webkit-user-select","none").css("user-select","none").css("-webkit-touch-callout","none"),r.on("contextmenu.wheelColorPicker",function(){return!1}),r.on("mousedown.wheelColorPicker",".jQWCP-wWheel",t.Handler.wheel_mousedown),r.on("touchstart.wheelColorPicker",".jQWCP-wWheel",t.Handler.wheel_mousedown),r.on("mousedown.wheelColorPicker",".jQWCP-wWheelCursor",t.Handler.wheelCursor_mousedown),r.on("touchstart.wheelColorPicker",".jQWCP-wWheelCursor",t.Handler.wheelCursor_mousedown),r.on("mousedown.wheelColorPicker",".jQWCP-slider",t.Handler.slider_mousedown),r.on("touchstart.wheelColorPicker",".jQWCP-slider",t.Handler.slider_mousedown),r.on("mousedown.wheelColorPicker",".jQWCP-scursor",t.Handler.sliderCursor_mousedown),r.on("touchstart.wheelColorPicker",".jQWCP-scursor",t.Handler.sliderCursor_mousedown),r.get(0)},t.ColorPicker.prototype.options=null,t.ColorPicker.prototype.input=null,t.ColorPicker.prototype.widget=null,t.ColorPicker.prototype.color=null,t.ColorPicker.prototype.lastValue=null,t.ColorPicker.prototype.setOptions=function(r){if(r=e.extend(!0,{},r),this.options.htmlOptions)for(var i in t.defaults)this.input.hasAttribute("data-wcp-"+i)&&void 0===r[i]&&(r[i]=this.input.getAttribute("data-wcp-"+i));for(var i in r)if(void 0!==this.options[i]){var s=i.charAt(0).toUpperCase()+i.slice(1);"function"==typeof this["set"+s]?this["set"+s](r[i]):this.options[i]=r[i]}return this},t.ColorPicker.prototype.init=function(){if(t.ColorPicker.init(),1!=this.hasInit){this.hasInit=!0;var r=e(this.input),i=null;"block"==this.options.layout?(this.widget=t.ColorPicker.createWidget(),i=e(this.widget),i.data("jQWCP.instance",this),i.insertAfter(this.input),"inline"==r.css("display")?i.css("display","inline-block"):i.css("display",r.css("display")),i.append(this.input),r.hide(),void 0!=r.attr("tabindex")?i.attr("tabindex",r.attr("tabindex")):i.attr("tabindex",0),this.refreshWidget(),this.redrawSliders(!0),this.updateSliders(),i.on("focus.wheelColorPicker",t.Handler.widget_focus_block),i.on("blur.wheelColorPicker",t.Handler.widget_blur_block)):(null==t.ColorPicker.widget&&(t.ColorPicker.widget=t.ColorPicker.createWidget(),i=e(t.ColorPicker.widget),i.hide(),e("body").append(i),i.on("mousedown.wheelColorPicker",t.Handler.widget_mousedown_popup)),this.widget=t.ColorPicker.widget,r.on("focus.wheelColorPicker",t.Handler.input_focus_popup),r.on("blur.wheelColorPicker",t.Handler.input_blur_popup)),r.on("keyup.wheelColorPicker",t.Handler.input_change),"object"==typeof this.options.color?(this.setColor(this.options.color),this.options.color=void 0):"string"==typeof this.options.color&&(this.setValue(this.options.color),this.options.color=void 0),this.options.userinput?r.removeAttr("readonly"):r.attr("readonly",!0)}},t.ColorPicker.prototype.destroy=function(){var t=e(this.widget),r=e(this.input);"block"==this.options.layout&&(t.before(this.input),t.remove(),r.show()),r.off("focus.wheelColorPicker"),r.off("blur.wheelColorPicker"),r.off("keyup.wheelColorPicker"),r.off("change.wheelColorPicker"),r.data("jQWCP.instance",null),delete this},t.ColorPicker.prototype.refreshWidget=function(){var t=e(this.widget);t.attr("class","jQWCP-wWidget"),"block"==this.options.layout&&t.addClass("jQWCP-block"),t.addClass(this.options.cssClass),t.find(".jQWCP-wWheel, .jQWCP-slider-wrapper, .jQWCP-wPreview").hide().addClass("hidden");for(var r in this.options.sliders){var i=null;switch(this.options.sliders[r]){case"w":i=t.find(".jQWCP-wWheel");break;case"h":i=t.find(".jQWCP-wHue");break;case"s":i=t.find(".jQWCP-wSat");break;case"v":i=t.find(".jQWCP-wVal");break;case"r":i=t.find(".jQWCP-wRed");break;case"g":i=t.find(".jQWCP-wGreen");break;case"b":i=t.find(".jQWCP-wBlue");break;case"a":i=t.find(".jQWCP-wAlpha");break;case"p":i=t.find(".jQWCP-wPreview")}null!=i&&(i.appendTo(this.widget),i.show().removeClass("hidden"))}var s=50*this.options.quality;t.find(".jQWCP-slider").attr("height",s);var o=t.find(".jQWCP-wWheel, .jQWCP-slider-wrapper, .jQWCP-wPreview").not(".hidden"),a=0;return o.each(function(t,r){a+=parseFloat(e(r).css("margin-right").replace("px",""))+e(r).outerWidth()}),t.css({width:a+"px"}),this},t.ColorPicker.prototype.redrawSliders=function(t){if(null==this.widget)return this;var r=e(this.widget);if("string"==typeof arguments[0]&&(t=arguments[1]),this!=r.data("jQWCP.instance"))return this;var i=1,s=50*this.options.quality,o=1,a=0,n=0,l=0,d=0,h=0,u=1;this.options.live&&(o=this.color.a,a=Math.round(255*this.color.r),n=Math.round(255*this.color.g),l=Math.round(255*this.color.b),d=this.color.h,h=this.color.s,u=this.color.v);var c=r.find(".jQWCP-wPreviewBox");if(!c.hasClass("hidden")){var p=c.get(0).getContext("2d");p.fillStyle="rgba("+a+","+n+","+l+","+o+")",p.clearRect(0,0,1,1),p.fillRect(0,0,1,1)}if(!this.options.live&&!t)return this;var C=r.find(".jQWCP-wAlphaSlider");if(!C.hasClass("hidden")||t){var f=C.get(0).getContext("2d"),g=f.createLinearGradient(0,0,0,s);g.addColorStop(0,"rgba("+a+","+n+","+l+",1)"),g.addColorStop(1,"rgba("+a+","+n+","+l+",0)"),f.fillStyle=g,f.clearRect(0,0,i,s),f.fillRect(0,0,i,s)}var v=r.find(".jQWCP-wRedSlider");if(!v.hasClass("hidden")||t){var P=v.get(0).getContext("2d"),w=P.createLinearGradient(0,0,0,s);w.addColorStop(0,"rgb(255,"+n+","+l+")"),w.addColorStop(1,"rgb(0,"+n+","+l+")"),P.fillStyle=w,P.fillRect(0,0,i,s)}var W=r.find(".jQWCP-wGreenSlider");if(!W.hasClass("hidden")||t){var b=W.get(0).getContext("2d"),j=b.createLinearGradient(0,0,0,s);j.addColorStop(0,"rgb("+a+",255,"+l+")"),j.addColorStop(1,"rgb("+a+",0,"+l+")"),b.fillStyle=j,b.fillRect(0,0,i,s)}var Q=r.find(".jQWCP-wBlueSlider");if(!Q.hasClass("hidden")||t){var k=Q.get(0).getContext("2d"),y=k.createLinearGradient(0,0,0,s);y.addColorStop(0,"rgb("+a+","+n+",255)"),y.addColorStop(1,"rgb("+a+","+n+",0)"),k.fillStyle=y,k.fillRect(0,0,i,s)}var m=r.find(".jQWCP-wHueSlider");if(!m.hasClass("hidden")||t){var S=m.get(0).getContext("2d"),I=S.createLinearGradient(0,0,0,s);I.addColorStop(0,"#f00"),I.addColorStop(.166666667,"#ff0"),I.addColorStop(.333333333,"#0f0"),I.addColorStop(.5,"#0ff"),I.addColorStop(.666666667,"#00f"),I.addColorStop(.833333333,"#f0f"),I.addColorStop(1,"#f00"),S.fillStyle=I,S.fillRect(0,0,i,s)}var _=r.find(".jQWCP-wSatSlider");if(!_.hasClass("hidden")||t){var x=e.fn.wheelColorPicker.hsvToRgb(d,1,u);x.r=Math.round(255*x.r),x.g=Math.round(255*x.g),x.b=Math.round(255*x.b);var N=_.get(0).getContext("2d"),H=N.createLinearGradient(0,0,0,s);H.addColorStop(0,"rgb("+x.r+","+x.g+","+x.b+")"),H.addColorStop(1,"rgb("+Math.round(255*u)+","+Math.round(255*u)+","+Math.round(255*u)+")"),N.fillStyle=H,N.fillRect(0,0,i,s)}var R=r.find(".jQWCP-wValSlider");if(!R.hasClass("hidden")||t){var O=e.fn.wheelColorPicker.hsvToRgb(d,h,1);O.r=Math.round(255*O.r),O.g=Math.round(255*O.g),O.b=Math.round(255*O.b);var G=R.get(0).getContext("2d"),A=G.createLinearGradient(0,0,0,s);A.addColorStop(0,"rgb("+O.r+","+O.g+","+O.b+")"),A.addColorStop(1,"#000"),G.fillStyle=A,G.fillRect(0,0,i,s)}return this},t.ColorPicker.prototype.updateSliders=function(){if(null==this.widget)return this;var t=e(this.widget),r=this.color;if(this!=t.data("jQWCP.instance"))return this;var i=t.find(".jQWCP-wWheel");if(!i.hasClass("hidden")){var s=t.find(".jQWCP-wWheelCursor"),o=t.find(".jQWCP-wWheelOverlay"),a=Math.cos(2*Math.PI*r.h)*r.s,n=Math.sin(2*Math.PI*r.h)*r.s,l=i.width()/2,d=i.height()/2;s.css("left",l+a*i.width()/2+"px"),s.css("top",d-n*i.height()/2+"px"),1==this.options.preserveWheel||null==this.options.preserveWheel&&0==this.options.live?o.css("opacity",0):o.css("opacity",1-(r.v<.2?.2:r.v))}var h=t.find(".jQWCP-wHueSlider");if(!h.hasClass("hidden")){var u=t.find(".jQWCP-wHueCursor");u.css("top",r.h*h.height()+"px")}var c=t.find(".jQWCP-wSatSlider");if(!c.hasClass("hidden")){var p=t.find(".jQWCP-wSatCursor");p.css("top",(1-r.s)*c.height()+"px")}var C=t.find(".jQWCP-wValSlider");if(!C.hasClass("hidden")){var f=t.find(".jQWCP-wValCursor");f.css("top",(1-r.v)*C.height()+"px")}var g=t.find(".jQWCP-wRedSlider");if(!g.hasClass("hidden")){var v=t.find(".jQWCP-wRedCursor");v.css("top",(1-r.r)*g.height()+"px")}var P=t.find(".jQWCP-wGreenSlider");if(!P.hasClass("hidden")){var w=t.find(".jQWCP-wGreenCursor");w.css("top",(1-r.g)*P.height()+"px")}var W=t.find(".jQWCP-wBlueSlider");if(!W.hasClass("hidden")){var b=t.find(".jQWCP-wBlueCursor");b.css("top",(1-r.b)*W.height()+"px")}var j=t.find(".jQWCP-wAlphaSlider");if(!j.hasClass("hidden")){var Q=t.find(".jQWCP-wAlphaCursor");Q.css("top",(1-r.a)*j.height()+"px")}return this},t.ColorPicker.prototype.updateSelection=function(){return this.redrawSliders(),this.updateSliders(),this},t.ColorPicker.prototype.updateInput=function(){if(null==this.widget)return this;var r=e(this.input);this.input.value=this.getValue(),this.options.preview&&(r.css("background",t.colorToStr(this.color,"rgba")),this.color.v>.5?r.css("color","black"):r.css("color","white"))},t.ColorPicker.prototype.updateActiveControl=function(r){var i=e(e("body").data("jQWCP.activeControl"));if(0!=i.length){var s=(e(this.input),this.options),o=this.color;if(void 0==r.pageX&&r.originalEvent.touches.length>0&&(r.pageX=r.originalEvent.touches[0].pageX,r.pageY=r.originalEvent.touches[0].pageY),i.hasClass("jQWCP-wWheel")){var a=i.find(".jQWCP-wWheelCursor"),n=(i.find(".jQWCP-wWheelOverlay"),(r.pageX-i.offset().left-i.width()/2)/(i.width()/2)),l=-(r.pageY-i.offset().top-i.height()/2)/(i.height()/2);if(t.BUG_RELATIVE_PAGE_ORIGIN)var n=(r.pageX-(i.get(0).getBoundingClientRect().left-t.ORIGIN.left)-i.width()/2)/(i.width()/2),l=-(r.pageY-(i.get(0).getBoundingClientRect().top-t.ORIGIN.top)-i.height()/2)/(i.height()/2);var d=Math.sqrt(Math.pow(n,2)+Math.pow(l,2));d>1&&(d=1),s.snap&&d<s.snapTolerance&&(d=0);var h=0==n&&0==l?0:Math.atan(l/n)/(2*Math.PI);0>h&&(h+=.5),0>l&&(h+=.5),this.setHsv(h,d,o.v)}else if(i.hasClass("jQWCP-slider-wrapper")){var a=i.find(".jQWCP-scursor"),l=(r.pageY-i.offset().top)/i.height();if(t.BUG_RELATIVE_PAGE_ORIGIN)var l=(r.pageY-(i.get(0).getBoundingClientRect().top-t.ORIGIN.top))/i.height();var u=0>l?0:l>1?1:l;s.snap&&u<s.snapTolerance?u=0:s.snap&&u>1-s.snapTolerance&&(u=1),s.snap&&u>.5-s.snapTolerance&&u<.5+s.snapTolerance&&(u=.5),a.css("top",u*i.height()+"px"),i.hasClass("jQWCP-wRed")&&this.setRgb(1-u,o.g,o.b),i.hasClass("jQWCP-wGreen")&&this.setRgb(o.r,1-u,o.b),i.hasClass("jQWCP-wBlue")&&this.setRgb(o.r,o.g,1-u),i.hasClass("jQWCP-wHue")&&this.setHsv(u,o.s,o.v),i.hasClass("jQWCP-wSat")&&this.setHsv(o.h,1-u,o.v),i.hasClass("jQWCP-wVal")&&this.setHsv(o.h,o.s,1-u),i.hasClass("jQWCP-wAlpha")&&this.setAlpha(1-u)}}},t.ColorPicker.prototype.getColor=function(){return this.color},t.ColorPicker.prototype.getValue=function(e){return null==e&&(e=this.options.format),this.options.rounding>=0&&(this.color.a=Math.round(this.color.a*Math.pow(10,this.options.rounding))/Math.pow(10,this.options.rounding)),t.colorToStr(this.color,e)},t.ColorPicker.prototype.setValue=function(e){var r=t.strToColor(e);return r?this.setColor(r):this},t.ColorPicker.prototype.setColor=function(e){return"string"==typeof e?this.setValue(e):null!=e.r?this.setRgba(e.r,e.g,e.b,e.a):null!=e.h?this.setHsva(e.h,e.s,e.v,e.a):null!=e.a?this.setAlpha(e.a):this},t.ColorPicker.prototype.setRgba=function(e,r,i,s){this.color.r=e,this.color.g=r,this.color.b=i,null!=s&&(this.color.a=s);var o=t.rgbToHsv(e,r,i);return this.color.h=o.h,this.color.s=o.s,this.color.v=o.v,this.updateSliders(),this.redrawSliders(),this.updateInput(),this},t.ColorPicker.prototype.setRgb=function(e,t,r){return this.setRgba(e,t,r,null)},t.ColorPicker.prototype.setHsva=function(e,r,i,s){this.color.h=e,this.color.s=r,this.color.v=i,null!=s&&(this.color.a=s);var o=t.hsvToRgb(e,r,i);return this.color.r=o.r,this.color.g=o.g,this.color.b=o.b,this.updateSliders(),this.redrawSliders(),this.updateInput(),this},t.ColorPicker.prototype.setHsv=function(e,t,r){return this.setHsva(e,t,r,null)},t.ColorPicker.prototype.setAlpha=function(e){return this.color.a=e,this.updateSliders(),this.redrawSliders(),this.updateInput(),this},t.ColorPicker.prototype.show=function(){var r=e(this.input),i=e(this.widget);"popup"==this.options.layout&&(i.data("jQWCP.instance",this),i.stop(!0,!0),i.css({top:this.input.getBoundingClientRect().top-t.ORIGIN.top+r.outerHeight()+"px",left:this.input.getBoundingClientRect().left-t.ORIGIN.left+"px"}),this.refreshWidget(),this.redrawSliders(),this.updateSliders(),this.lastValue=this.input.value,i.fadeIn(this.options.animDuration),this.options.hideKeyboard&&(r.blur(),e(t.ColorPicker.overlay).show()))},t.ColorPicker.prototype.hide=function(){var r=e(this.widget);this==r.data("jQWCP.instance")&&(r.fadeOut(this.options.animDuration),e(t.ColorPicker.overlay).hide())},t.Handler={},t.Handler.input_focus_popup=function(t){var r=e(this).data("jQWCP.instance");r.show()},t.Handler.input_blur_popup=function(t){var r=e(this).data("jQWCP.instance");r.options.hideKeyboard||(r.hide(),r.lastValue!=this.value&&e(this).trigger("change"))},t.Handler.input_change=function(r){var i=e(this).data("jQWCP.instance"),s=t.strToColor(this.value);s&&i.setColor(s)},t.Handler.widget_focus_block=function(t){var r=e(this).data("jQWCP.instance"),i=e(r.input);r.lastValue=r.input.value,i.triggerHandler("focus")},t.Handler.widget_mousedown_popup=function(t){var r=e(this).data("jQWCP.instance"),i=e(r.input);if(i.off("focus.wheelColorPicker"),i.off("blur.wheelColorPicker"),void 0!=i.data("events"))var s=i.data("events").blur;else var s=void 0;var o={blur:[]};if(void 0!=s)for(var a=0;a<s.length;a++)o.blur.push(s[a]);i.data("jQWCP.suspendedEvents",o)},t.Handler.widget_blur_block=function(t){var r=e(this).data("jQWCP.instance"),i=e(r.input);r.lastValue!=r.input.value&&i.trigger("change"),i.triggerHandler("blur")},t.Handler.wheelCursor_mousedown=function(t){var r=e(this),i=r.closest(".jQWCP-wWidget"),s=i.data("jQWCP.instance"),o=e(s.input);e("body").data("jQWCP.activeControl",r.parent().get(0)),o.trigger("sliderdown")},t.Handler.wheel_mousedown=function(t){var r=e(this),i=r.closest(".jQWCP-wWidget"),s=i.data("jQWCP.instance"),o=e(s.input);e("body").data("jQWCP.activeControl",r.get(0)),o.trigger("sliderdown")},t.Handler.slider_mousedown=function(t){var r=e(this),i=r.closest(".jQWCP-wWidget"),s=i.data("jQWCP.instance"),o=e(s.input);e("body").data("jQWCP.activeControl",r.parent().get(0)),o.trigger("sliderdown")},t.Handler.sliderCursor_mousedown=function(t){var r=e(this),i=r.closest(".jQWCP-wWidget"),s=i.data("jQWCP.instance"),o=e(s.input);e("body").data("jQWCP.activeControl",r.parent().get(0)),o.trigger("sliderdown")},t.Handler.html_mouseup=function(r){var i=e(e("body").data("jQWCP.activeControl"));if(0!=i.length){var s=i.closest(".jQWCP-wWidget"),o=s.data("jQWCP.instance"),a=e(o.input);if("popup"==o.options.layout){o.options.hideKeyboard||a.trigger("focus.jQWCP_DONT_TRIGGER_EVENTS"),a.on("focus.wheelColorPicker",t.Handler.input_focus_popup),a.on("blur.wheelColorPicker",t.Handler.input_blur_popup);for(var n=a.data("jQWCP.suspendedEvents"),l=n.blur,d=0;d<l.length;d++)a.on("blur"+(""==l[d].namespace?"":"."+l[d].namespace),l[d].handler)}0!=i.length&&(void 0!=r.pageX&&o.updateActiveControl(r),e("body").data("jQWCP.activeControl",null),a.trigger("sliderup"))}},t.Handler.html_mousemove=function(t){var r=e(e("body").data("jQWCP.activeControl"));if(0!=r.length){t.preventDefault();var i=r.closest(".jQWCP-wWidget"),s=i.data("jQWCP.instance"),o=e(s.input);return s.updateActiveControl(t),o.trigger("slidermove"),!1}},t.Handler.overlay_click=function(r){if(null!=t.ColorPicker.widget){var i=e(t.ColorPicker.widget),s=i.data("jQWCP.instance");if(null!=s){var o=e(s.input);s.lastValue!=s.input.value&&o.trigger("change"),s.hide()}}},e(document).ready(function(){e("[data-wheelcolorpicker]").wheelColorPicker({htmlOptions:!0})}),function(){void 0!=e.browser&&e.browser.mozilla&&(e.fn.wheelColorPicker.defaults.quality=.2),e(document).ready(function(){e("body").append('<div id="jQWCP-PageOrigin" style="position: absolute; top: 0; left: 0; height: 0; width: 0;"></div>');var r=document.getElementById("jQWCP-PageOrigin").getBoundingClientRect();t.ORIGIN=r,e(window).on("scroll.jQWCP_RelativePageOriginBugFix",function(){var e=document.getElementById("jQWCP-PageOrigin").getBoundingClientRect();t.ORIGIN=e,(0!=e.left||0!=e.top)&&(t.BUG_RELATIVE_PAGE_ORIGIN=!0)})})}()}(jQuery);
